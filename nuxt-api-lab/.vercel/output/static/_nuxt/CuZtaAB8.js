import{_ as L}from"./C7BYr_Dn.js";import{g as x,j as k,k as C,o as f,c as N,a as p,b as d,w as _,d as y,l as M,m as E,t as T,n as z,r as m,p as I}from"./BxqDI8qG.js";import{B as v,a as S,b as h}from"./B0TTSZ-O.js";const O={class:"space-y-4"},U=x({__name:"MapView.client",setup(b){const n=m(""),t=m(""),l=m(""),r=m(null),w=I(()=>!!(n.value.trim()||t.value&&l.value));let s=null,c=null,g=null,u=null;k(async()=>{u=await C(()=>import("./CjPBq9Bq.js").then(e=>e.l),[],import.meta.url);const a=document.getElementById("map");!a||!u||(s=u.map(a).setView([45.4642,9.19],6),g=u.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}),g.addTo(s),s.on("click",e=>{const{lat:o,lng:i}=e.latlng;t.value=o.toFixed(6),l.value=i.toFixed(6),n.value="",V(o,i)}),setTimeout(()=>s?.invalidateSize(),0))});async function B(){r.value=null;try{if(n.value.trim()){const i=(await $fetch("/api/map/geocode",{params:{q:n.value}}))[0];if(!i){r.value="Nessun risultato trovato";return}t.value=i.lat,l.value=i.lon}if(!t.value||!l.value){r.value="Inserisci una città o coordinate";return}const a=Number(t.value),e=Number(l.value);if(Number.isNaN(a)||Number.isNaN(e)){r.value="Coordinate non valide";return}V(a,e)}catch(a){console.error(a),r.value="Errore nella ricerca della località"}}function V(a,e){!s||!u||(s.setView([a,e],12),c?c.setLatLng([a,e]):c=u.marker([a,e]).addTo(s))}return(a,e)=>(f(),N("div",O,[p("form",{class:"grid grid-cols-1 md:grid-cols-4 gap-2",onSubmit:M(B,["prevent"])},[d(v,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),placeholder:"Città o indirizzo"},null,8,["modelValue"]),d(v,{modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value=o),placeholder:"Latitudine"},null,8,["modelValue"]),d(v,{modelValue:l.value,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value=o),placeholder:"Longitudine"},null,8,["modelValue"]),d(S,{type:"submit",size:"sm",disabled:!w.value},{default:_(()=>[...e[3]||(e[3]=[y("Cerca",-1)])]),_:1},8,["disabled"])],32),e[4]||(e[4]=p("div",{id:"map",class:"h-[500px] w-full rounded-lg shadow"},null,-1)),r.value?(f(),E(h,{key:0,type:"error"},{default:_(()=>[y(T(r.value),1)]),_:1})):z("",!0)]))}}),$=Object.assign(U,{__name:"MapView"}),j={class:"p-6 space-y-4"},F=x({__name:"maps",setup(b){return(n,t)=>{const l=L;return f(),N("div",j,[t[0]||(t[0]=p("h1",{class:"text-3xl font-bold"},"Mappe interattive",-1)),t[1]||(t[1]=p("p",{class:"text-gray-600 max-w-2xl"}," In questa pagina integriamo una mappa interattiva con Leaflet. ",-1)),d(l,null,{default:_(()=>[d($)]),_:1})])}}});export{F as default};
